<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vessel CII Calculator & Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-slate-100 font-sans min-h-screen">

    <nav class="bg-slate-900 text-white p-6 shadow-xl">
        <div class="max-w-5xl mx-auto">
            <h1 class="text-xl font-bold tracking-tight text-center md:text-left">MARITIME<span class="text-blue-400">CII</span> ANALYTICS</h1>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-6 grid lg:grid-cols-3 gap-8">
        
        <section class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
            <h2 class="text-xl font-bold mb-4 text-slate-800 border-b pb-2">Vessel Inputs</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase">Capacity (DWT)</label>
                    <input type="number" id="capacity" value="60000" class="w-full p-3 border rounded-lg bg-slate-50">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase">Fuel Consumed (mt)</label>
                    <input type="number" id="fuel" value="1200" class="w-full p-3 border rounded-lg bg-slate-50">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase">Distance (nm)</label>
                    <input type="number" id="distance" value="30000" class="w-full p-3 border rounded-lg bg-slate-50">
                </div>
                <button onclick="calculateCII()" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl hover:bg-blue-700 transition shadow-lg">
                    Update Analysis
                </button>
            </div>
        </section>

        <section class="lg:col-span-2 space-y-6">
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                <h2 class="text-xl font-bold mb-4 text-slate-800">CII Performance Diagram</h2>
                <div class="relative h-64 w-full">
                    <canvas id="ciiChart"></canvas>
                </div>
                <div class="mt-6 p-4 bg-slate-50 rounded-lg flex justify-between items-center">
                    <div>
                        <p class="text-xs font-bold text-slate-400 uppercase">Current Rating</p>
                        <p id="ratingText" class="text-3xl font-black text-blue-600">--</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs font-bold text-slate-400 uppercase">Attained CII</p>
                        <p id="ciiVal" class="text-3xl font-mono font-bold text-slate-800">0.00</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        let myChart;

        function calculateCII() {
            const capacity = parseFloat(document.getElementById('capacity').value);
            const fuel = parseFloat(document.getElementById('fuel').value);
            const distance = parseFloat(document.getElementById('distance').value);
            
            // Attained CII Formula
            const attained = (fuel * 3.114 * 1000000) / (capacity * distance);
            
            // Reference Values (Example for Bulk Carrier)
            const ref = 4745 * Math.pow(capacity, -0.622);
            
            document.getElementById('ciiVal').innerText = attained.toFixed(3);
            updateChart(attained, ref);
        }

        function updateChart(attained, ref) {
            const ctx = document.getElementById('ciiChart').getContext('2d');
            
            // Define Rating Thresholds
            const a = ref * 0.83;
            const b = ref * 0.94;
            const c = ref * 1.06;
            const d = ref * 1.28;

            // Update Rating Text
            let rating = 'E';
            let color = '#ef4444';
            if (attained < a) { rating = 'A'; color = '#22c55e'; }
            else if (attained < b) { rating = 'B'; color = '#4ade80'; }
            else if (attained < c) { rating = 'C'; color = '#facc15'; }
            else if (attained < d) { rating = 'D'; color = '#fb923c'; }
            
            document.getElementById('ratingText').innerText = rating;
            document.getElementById('ratingText').style.color = color;

            if (myChart) myChart.destroy();

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['A (Top)', 'B', 'C (Required)', 'D', 'E (Bottom)', 'YOUR VESSEL'],
                    datasets: [{
                        label: 'CII Value',
                        data: [a, b, c, d, d * 1.5, attained],
                        backgroundColor: ['#22c55e', '#4ade80', '#facc15', '#fb923c', '#ef4444', '#2563eb'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'gCO2 / t-nm' } } }
                }
            });
        }

        // Run once on load
        calculateCII();
    </script>
</body>
</html>
